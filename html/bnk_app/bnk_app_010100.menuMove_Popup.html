<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>메뉴이동 팝업</title>
    <link rel="stylesheet" href="../../css/style.css">
    <script src="../../lib/Sortable.min.js"></script>
</head>

<body>
    <div class="tree_menu"></div>
    <script>
            let jsonData = [
                {
                        "name": "i-ONE뱅크(개인)",
                        "depth": 1,
                        "use_state" : true,
                        "state_1" : false,
                        "state_2" : false,
                        "children": [
                            {
                                "name": "메인",
                                "depth": 2,
                                "use_state" : true,
                                "state_1" : true,
                                "state_2" : false,
                                "children": [
                                    {
                                        "name": "개인형IRP링크",
                                        "depth": 3,
                                        "use_state" : true,
                                        "state_1" : true,
                                        "state_2" : false
                                    },
                                    {   
                                        "name": "카드혜택",
                                        "depth": 3,
                                        "use_state" : true,
                                        "state_1" : true,
                                        "state_2" : false
                                    }
                                ]
                            },
                            {
                                "name": "로그인",
                                "depth": 2,
                                "use_state" : true,
                                "state_1" : true,
                                "state_2" : false,
                                "children": [
                                    {
                                        "name": "바이오인증",
                                        "depth": 3,
                                        "use_state" : true,
                                        "state_1" : true,
                                        "state_2" : false,
                                        "children": [
                                            {
                                                "name": "얼굴로그인",
                                                "depth": 4,
                                                "use_state" : true,
                                                "state_1" : true,
                                                "state_2" : true
                                            },
                                            {
                                                "name": "홍채로그인",
                                                "depth": 4,
                                                "use_state" : true,
                                                "state_1" : true,
                                                "state_2" : true
                                            }
                                        ]
                                    },
                                    {
                                        "name": "기타 로그인 수단",
                                        "depth": 3,
                                        "use_state" : true,
                                        "state_1" : true,
                                        "state_2" : false,
                                        "children": [
                                            {
                                                "name": "ONE아이디",
                                                "depth": 4,
                                                "use_state" : false,
                                                "state_1" : true,
                                                "state_2" : false
                                            },
                                            {
                                                "name": "공인인증서",
                                                "depth": 4,
                                                "use_state" : false,
                                                "state_1" : true,
                                                "state_2" : false
                                            },
                                            {
                                                "name": "뱅크사인",
                                                "depth": 4,
                                                "use_state" : true,
                                                "state_1" : true,
                                                "state_2" : false
                                            },
                                            {
                                                "name": "금융인증서",
                                                "depth": 4,
                                                "use_state" : true,
                                                "state_1" : true,
                                                "state_2" : true
                                            },
                                            {
                                                "name": "뱅크아이디",
                                                "depth": 4,
                                                "use_state" : false,
                                                "state_1" : true,
                                                "state_2" : true
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ]

                let list = document.querySelector(".tree_menu");
        createTree(list, jsonData);

        function createTree(container, nodes){
            
            container.innerHTML = "";
            
            nodes.forEach(item => {
                let li = document.createElement("li");
                li.classList.add("tree-item");
                li.dataset.id = item.id;
                li.innerHTML = item.name;

                let ul = document.createElement("ul");
                ul.classList.add("tree", "nested");

                if(item.children && item.children.length > 0){
                    createTree(ul, item.children);
                    li.appendChild(ul);
                }
                container.appendChild(li);

                new Sortable(container, {
                    animation: 150,
                    group: nodes.depth,
                    selectedClass: 'selected',
                    onEnd: updateTreeData
                });                
            });
        
        }

        function updateTreeData(){

        }
    </script>
</body>

</html>